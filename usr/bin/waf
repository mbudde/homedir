#!/bin/bash

find_waf() {
    this_script="$(dirname "$0")/waf"
    tried=""
    dir=$(pwd)
    while [ "$dir" != "/" ]; do
        wafbin="$dir/waf"
        if [ "$wafbin" != "$this_script" ]; then
            tried="$tried  $wafbin\n"
            if [ -f "$wafbin" -a -x "$wafbin" ]; then
                echo "$wafbin"
                return 0
            fi
        fi
        dir=$(dirname "$dir")
    done
    wafbin=$(which waf.real 2>/dev/null)
    tried="$tried  waf.real in PATH"
    if [ -x "$wafbin" ]; then
        echo "$wafbin"
        return 0
    fi
    echo "Could not find waf executable" >&2
    echo "Tried the following places:" >&2
    echo -e "$tried" >&2
    return 1
}

waf=$(find_waf)
if [ -n "$waf" ]; then
    "$waf" "$@"
fi
